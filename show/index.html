<!DOCTYPE html>
<head>
    <style>
        *{
            margin: 0;
            padding: 0;
            font-size: 12px;
        }
    </style>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <!-- 开发环境版本，包含了有帮助的命令行警告 -->
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<!-- 生产环境版本，优化了尺寸和速度 -->
	<!--<script src="https://cdn.jsdelivr.net/npm/vue"></script>-->
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
</head>
<body>
    <div id="app">
        <div v-for='item in huyadata' v-on:key="item.pentaid" style="padding-left:5%;padding-right: 5%;width: 90%;margin: 0 auto;">

            <div style="width:20rem;float:left;height: 15rem;" onclick="getdata">
                <div>
                    {{
                        item.title
                    }}
                </div>
                <div>
                    <a :href="item.url">
                        <img :src='item.imgurl' alt="图片路径" width="200px" height="120px">
                    </a>
                    
                </div>
                <div>
                    {{
                        item.author
                    }}
                </div>
                <div>
                    {{
                        item.time
                    }}
                </div>
                
            </div>
            
        </div>
    </div>

    <script type="text/javascript">
        var app = new Vue({
            el:'#app',
            data:{
                huyadata:'',
                datalength:0
            },
            beforeMount: function(){
                console.log("created 生命周期执行")
                //getdata();
                
                this.getdata()
                window.addEventListener('scroll', this.scrollHandle)
                
            },
            methods:{
                getdata:function(datalength){
                    axios.get('http://localhost:8080/huyapenta/'+ String(this.datalength)).then(res => {
                    console.log(res)
                    this.huyadata = res.data.result
                    console.log(this.datalength)
                    })
                },
                scrollHandle:function(e){
                    len = this.datalength
                    console.log(len)
                    var top = e.srcElement.scrollingElement.scrollTop;    // 获取页面滚动高度
                    console.log(top)
                    this.datalength = Math.floor(top/400)
                    console.log(this.datalength)
                    if(len !== this.datalength){
                        this.getdata()
                        console.log("数据更新")
                    }
                }
            }
        })
    </script>
</body>
    
</html>